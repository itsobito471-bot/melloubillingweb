"use strict";(self.webpackChunkmellou_billing=self.webpackChunkmellou_billing||[]).push([[733],{7733:(un,V,p)=>{p.r(V),p.d(V,{ExpensesModule:()=>hn});var h=p(6895),_=p(433),L=p(4575),t=p(4650),q=p(4239),J=p(9651),Q=p(1971),C=p(8717),F=p(6616),D=p(7044),B=p(1811),T=p(1102),U=p(3679),I=p(8231),K=p(6672),E=p(5259),G=p(6497);function pt(n,s){if(1&n&&t._UZ(0,"nz-option",13),2&n){const e=s.$implicit;t.Q6J("nzValue",e._id)("nzLabel",e.name)}}function ct(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.ALo(3,"date"),t.qZA(),t.TgZ(4,"td")(5,"nz-tag",14),t._uU(6),t.qZA()(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td")(12,"strong"),t._uU(13),t.qZA()(),t.TgZ(14,"td")(15,"button",15),t.NdJ("click",function(){const o=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.navigateToEdit(o._id))}),t._UZ(16,"i",16),t.qZA(),t.TgZ(17,"button",17),t.NdJ("nzOnConfirm",function(){const o=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.deleteExpense(o._id))}),t._UZ(18,"i",18),t.qZA()()()}if(2&n){const e=s.$implicit;t.xp6(2),t.Oqu(t.xi3(3,6,e.date,"mediumDate")),t.xp6(3),t.Q6J("nzColor","blue"),t.xp6(1),t.Oqu((null==e.category?null:e.category.name)||"Uncategorized"),t.xp6(2),t.Oqu(e.description),t.xp6(2),t.Oqu(e.paymentMethod),t.xp6(3),t.hij("\u20b9",e.amount,"")}}const dt=function(){return[16,16]},gt=function(){return{x:"900px"}};let mt=(()=>{const s=class{constructor(i,a,o){this.appService=i,this.message=a,this.router=o,this.expenses=[],this.categories=[],this.loading=!1,this.filterCategoryId=null,this.dateRange=[],this.page=1,this.limit=10,this.total=0}ngOnInit(){this.loadCategories(),this.loadExpenses()}loadCategories(){this.appService.getExpenseCategories().subscribe(i=>this.categories=i)}loadExpenses(){this.loading=!0;const i={page:this.page,limit:this.limit};this.filterCategoryId&&(i.categoryId=this.filterCategoryId),2===this.dateRange.length&&(i.startDate=this.dateRange[0].toISOString(),i.endDate=this.dateRange[1].toISOString()),this.appService.getExpenses(i).subscribe({next:a=>{this.expenses=a.data,this.total=a.pagination.total,this.loading=!1},error:()=>{this.message.error("Failed to load expenses"),this.loading=!1}})}onFilterChange(){this.page=1,this.loadExpenses()}onPageIndexChange(i){this.page=i,this.loadExpenses()}deleteExpense(i){this.appService.deleteExpense(i).subscribe({next:()=>{this.message.success("Expense deleted"),this.loadExpenses()},error:()=>this.message.error("Failed to delete expense")})}navigateToCreate(){this.router.navigate(["/expenses/create"])}navigateToEdit(i){this.router.navigate(["/expenses/edit",i])}navigateToCategories(){this.router.navigate(["/expenses/categories"])}};let n=s;return s.\u0275fac=function(a){return new(a||s)(t.Y36(q.z),t.Y36(J.dD),t.Y36(L.F0))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-expense-list"]],decls:33,vars:30,consts:[["nzTitle","Expense Management"],["nz-row","",1,"header-actions",2,"margin-bottom","24px",3,"nzGutter"],["nz-col","",3,"nzXs","nzSm","nzMd","nzLg"],["nzPlaceHolder","Filter by Category","nzAllowClear","",2,"width","100%",3,"ngModel","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],[2,"width","100%",3,"ngModel","ngModelChange"],["nz-button","","nzType","default",2,"width","100%",3,"click"],["nz-icon","","nzType","appstore"],["nz-button","","nzType","primary",2,"width","100%",3,"click"],["nz-icon","","nzType","plus"],[3,"nzData","nzLoading","nzFrontPagination","nzTotal","nzPageIndex","nzPageSize","nzScroll","nzPageIndexChange"],["expenseTable",""],[4,"ngFor","ngForOf"],[3,"nzValue","nzLabel"],[3,"nzColor"],["nz-button","","nzType","link",3,"click"],["nz-icon","","nzType","edit"],["nz-button","","nzType","link","nzDanger","","nz-popconfirm","","nzPopconfirmTitle","Delete this expense?",3,"nzOnConfirm"],["nz-icon","","nzType","delete"]],template:function(a,o){if(1&a&&(t.TgZ(0,"nz-card",0)(1,"div",1)(2,"div",2)(3,"nz-select",3),t.NdJ("ngModelChange",function(l){return o.filterCategoryId=l})("ngModelChange",function(){return o.onFilterChange()}),t.YNc(4,pt,1,2,"nz-option",4),t.qZA()(),t.TgZ(5,"div",2)(6,"nz-range-picker",5),t.NdJ("ngModelChange",function(l){return o.dateRange=l})("ngModelChange",function(){return o.onFilterChange()}),t.qZA()(),t.TgZ(7,"div",2)(8,"button",6),t.NdJ("click",function(){return o.navigateToCategories()}),t._UZ(9,"i",7),t._uU(10," Categories "),t.qZA()(),t.TgZ(11,"div",2)(12,"button",8),t.NdJ("click",function(){return o.navigateToCreate()}),t._UZ(13,"i",9),t._uU(14," Add Expense "),t.qZA()()(),t.TgZ(15,"nz-table",10,11),t.NdJ("nzPageIndexChange",function(l){return o.onPageIndexChange(l)}),t.TgZ(17,"thead")(18,"tr")(19,"th"),t._uU(20,"Date"),t.qZA(),t.TgZ(21,"th"),t._uU(22,"Category"),t.qZA(),t.TgZ(23,"th"),t._uU(24,"Description"),t.qZA(),t.TgZ(25,"th"),t._uU(26,"Payment Method"),t.qZA(),t.TgZ(27,"th"),t._uU(28,"Amount"),t.qZA(),t.TgZ(29,"th"),t._uU(30,"Actions"),t.qZA()()(),t.TgZ(31,"tbody"),t.YNc(32,ct,19,9,"tr",12),t.qZA()()()),2&a){const r=t.MAs(16);t.xp6(1),t.Q6J("nzGutter",t.DdM(28,dt)),t.xp6(1),t.Q6J("nzXs",24)("nzSm",24)("nzMd",12)("nzLg",6),t.xp6(1),t.Q6J("ngModel",o.filterCategoryId),t.xp6(1),t.Q6J("ngForOf",o.categories),t.xp6(1),t.Q6J("nzXs",24)("nzSm",24)("nzMd",12)("nzLg",8),t.xp6(1),t.Q6J("ngModel",o.dateRange),t.xp6(1),t.Q6J("nzXs",24)("nzSm",12)("nzMd",12)("nzLg",5),t.xp6(4),t.Q6J("nzXs",24)("nzSm",12)("nzMd",12)("nzLg",5),t.xp6(4),t.Q6J("nzData",o.expenses)("nzLoading",o.loading)("nzFrontPagination",!1)("nzTotal",o.total)("nzPageIndex",o.page)("nzPageSize",o.limit)("nzScroll",t.DdM(29,gt)),t.xp6(17),t.Q6J("ngForOf",r.data)}},dependencies:[h.sg,_.JJ,_.On,Q.bd,C.N8,C.Uo,C._C,C.Om,C.p0,C.$Z,F.ix,D.w,B.dQ,T.Ls,U.t3,U.SK,I.Ip,I.Vq,K.j,E.uw,E.wS,G.JW,h.uU]}),n})();var W=p(5635),y=p(6704),k=p(7570),X=p(7096),_t=p(9521),O=p(529),$=p(7579),Z=p(9646),b=p(9751),tt=p(727),Y=p(4968),M=p(3900),R=p(4004),ht=p(8505),v=p(2722),ut=p(9300),j=p(8932),w=p(7340),et=p(3353),P=p(445),nt=p(6287),u=p(7582),N=p(2536),z=p(3187);function ft(n,s){if(1&n&&(t.ynx(0),t._UZ(1,"span",8),t.BQk()),2&n){const e=t.oxw(3);t.xp6(1),t.Q6J("nzType",e.icon)}}function zt(n,s){if(1&n&&(t.ynx(0),t._uU(1),t.BQk()),2&n){const e=s.$implicit,i=t.oxw(4);t.xp6(1),t.hij(" ",e(i.nzPercent)," ")}}const xt=function(n){return{$implicit:n}};function Ct(n,s){if(1&n&&t.YNc(0,zt,2,1,"ng-container",9),2&n){const e=t.oxw(3);t.Q6J("nzStringTemplateOutlet",e.formatter)("nzStringTemplateOutletContext",t.VKq(2,xt,e.nzPercent))}}function yt(n,s){if(1&n&&(t.TgZ(0,"span",5),t.YNc(1,ft,2,1,"ng-container",6),t.YNc(2,Ct,1,4,"ng-template",null,7,t.W1O),t.qZA()),2&n){const e=t.MAs(3),i=t.oxw(2);t.xp6(1),t.Q6J("ngIf",("exception"===i.status||"success"===i.status)&&!i.nzFormat)("ngIfElse",e)}}function Tt(n,s){if(1&n&&t.YNc(0,yt,4,2,"span",4),2&n){const e=t.oxw();t.Q6J("ngIf",e.nzShowInfo)}}function vt(n,s){if(1&n&&t._UZ(0,"div",17),2&n){const e=t.oxw(4);t.Udp("width",e.nzSuccessPercent,"%")("border-radius","round"===e.nzStrokeLinecap?"100px":"0")("height",e.strokeWidth,"px")}}function wt(n,s){if(1&n&&(t.TgZ(0,"div",13)(1,"div",14),t._UZ(2,"div",15),t.YNc(3,vt,1,6,"div",16),t.qZA()()),2&n){const e=t.oxw(3);t.xp6(2),t.Udp("width",e.nzPercent,"%")("border-radius","round"===e.nzStrokeLinecap?"100px":"0")("background",e.isGradient?null:e.nzStrokeColor)("background-image",e.isGradient?e.lineGradient:null)("height",e.strokeWidth,"px"),t.xp6(1),t.Q6J("ngIf",e.nzSuccessPercent||0===e.nzSuccessPercent)}}function Nt(n,s){}function St(n,s){if(1&n&&(t.ynx(0),t.YNc(1,wt,4,11,"div",11),t.YNc(2,Nt,0,0,"ng-template",12),t.BQk()),2&n){const e=t.oxw(2),i=t.MAs(1);t.xp6(1),t.Q6J("ngIf",!e.isSteps),t.xp6(1),t.Q6J("ngTemplateOutlet",i)}}function Ut(n,s){1&n&&t._UZ(0,"div",20),2&n&&t.Q6J("ngStyle",s.$implicit)}function bt(n,s){}function Lt(n,s){if(1&n&&(t.TgZ(0,"div",18),t.YNc(1,Ut,1,1,"div",19),t.YNc(2,bt,0,0,"ng-template",12),t.qZA()),2&n){const e=t.oxw(2),i=t.MAs(1);t.xp6(1),t.Q6J("ngForOf",e.steps),t.xp6(1),t.Q6J("ngTemplateOutlet",i)}}function Ft(n,s){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,St,3,2,"ng-container",2),t.YNc(2,Lt,3,2,"div",10),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",!e.isSteps),t.xp6(1),t.Q6J("ngIf",e.isSteps)}}function Zt(n,s){if(1&n&&(t.O4$(),t._UZ(0,"stop")),2&n){const e=s.$implicit;t.uIk("offset",e.offset)("stop-color",e.color)}}function It(n,s){if(1&n&&(t.O4$(),t.TgZ(0,"defs")(1,"linearGradient",24),t.YNc(2,Zt,1,2,"stop",25),t.qZA()()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("id","gradient-"+e.gradientId),t.xp6(1),t.Q6J("ngForOf",e.circleGradient)}}function kt(n,s){if(1&n&&(t.O4$(),t._UZ(0,"path",26)),2&n){const e=s.$implicit,i=t.oxw(2);t.Q6J("ngStyle",e.strokePathStyle),t.uIk("d",i.pathString)("stroke-linecap",i.nzStrokeLinecap)("stroke",e.stroke)("stroke-width",i.nzPercent?i.strokeWidth:0)}}function Ot(n,s){1&n&&t.O4$()}function Mt(n,s){if(1&n&&(t.TgZ(0,"div",14),t.O4$(),t.TgZ(1,"svg",21),t.YNc(2,It,3,2,"defs",2),t._UZ(3,"path",22),t.YNc(4,kt,1,5,"path",23),t.qZA(),t.YNc(5,Ot,0,0,"ng-template",12),t.qZA()),2&n){const e=t.oxw(),i=t.MAs(1);t.Udp("width",e.nzWidth,"px")("height",e.nzWidth,"px")("font-size",.15*e.nzWidth+6,"px"),t.ekj("ant-progress-circle-gradient",e.isGradient),t.xp6(2),t.Q6J("ngIf",e.isGradient),t.xp6(1),t.Q6J("ngStyle",e.trailPathStyle),t.uIk("stroke-width",e.strokeWidth)("d",e.pathString),t.xp6(1),t.Q6J("ngForOf",e.progressCirclePath)("ngForTrackBy",e.trackByFn),t.xp6(1),t.Q6J("ngTemplateOutlet",i)}}const it=n=>{let s=[];return Object.keys(n).forEach(e=>{const i=n[e],a=function Pt(n){return+n.replace("%","")}(e);isNaN(a)||s.push({key:a,value:i})}),s=s.sort((e,i)=>e.key-i.key),s};let Qt=0;const ot="progress",Dt=new Map([["success","check"],["exception","close"]]),Et=new Map([["normal","#108ee9"],["exception","#ff5500"],["success","#87d068"]]),$t=n=>`${n}%`;let Yt=(()=>{class n{constructor(e,i,a){this.cdr=e,this.nzConfigService=i,this.directionality=a,this._nzModuleName=ot,this.nzShowInfo=!0,this.nzWidth=132,this.nzStrokeColor=void 0,this.nzSize="default",this.nzPercent=0,this.nzStrokeWidth=void 0,this.nzGapDegree=void 0,this.nzType="line",this.nzGapPosition="top",this.nzStrokeLinecap="round",this.nzSteps=0,this.steps=[],this.lineGradient=null,this.isGradient=!1,this.isSteps=!1,this.gradientId=Qt++,this.progressCirclePath=[],this.trailPathStyle=null,this.dir="ltr",this.trackByFn=o=>`${o}`,this.cachedStatus="normal",this.inferredStatus="normal",this.destroy$=new $.x}get formatter(){return this.nzFormat||$t}get status(){return this.nzStatus||this.inferredStatus}get strokeWidth(){return this.nzStrokeWidth||("line"===this.nzType&&"small"!==this.nzSize?8:6)}get isCircleStyle(){return"circle"===this.nzType||"dashboard"===this.nzType}ngOnChanges(e){const{nzSteps:i,nzGapPosition:a,nzStrokeLinecap:o,nzStrokeColor:r,nzGapDegree:l,nzType:c,nzStatus:d,nzPercent:m,nzSuccessPercent:x,nzStrokeWidth:g}=e;d&&(this.cachedStatus=this.nzStatus||this.cachedStatus),(m||x)&&(parseInt(this.nzPercent.toString(),10)>=100?((0,z.DX)(this.nzSuccessPercent)&&this.nzSuccessPercent>=100||void 0===this.nzSuccessPercent)&&(this.inferredStatus="success"):this.inferredStatus=this.cachedStatus),(d||m||x||r)&&this.updateIcon(),r&&this.setStrokeColor(),(a||o||l||c||m||r||r)&&this.getCirclePaths(),(m||i||g)&&(this.isSteps=this.nzSteps>0,this.isSteps&&this.getSteps())}ngOnInit(){this.nzConfigService.getConfigChangeEventForComponent(ot).pipe((0,v.R)(this.destroy$)).subscribe(()=>{this.updateIcon(),this.setStrokeColor(),this.getCirclePaths()}),this.directionality.change?.pipe((0,v.R)(this.destroy$)).subscribe(e=>{this.dir=e,this.cdr.detectChanges()}),this.dir=this.directionality.value}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}updateIcon(){const e=Dt.get(this.status);this.icon=e?e+(this.isCircleStyle?"-o":"-circle-fill"):""}getSteps(){const e=Math.floor(this.nzSteps*(this.nzPercent/100)),i="small"===this.nzSize?2:14,a=[];for(let o=0;o<this.nzSteps;o++){let r;o<=e-1&&(r=this.nzStrokeColor),a.push({backgroundColor:`${r}`,width:`${i}px`,height:`${this.strokeWidth}px`})}this.steps=a}getCirclePaths(){if(!this.isCircleStyle)return;const e=(0,z.DX)(this.nzSuccessPercent)?[this.nzSuccessPercent,this.nzPercent]:[this.nzPercent],i=50-this.strokeWidth/2,o=2*Math.PI*i,r=this.nzGapDegree||("circle"===this.nzType?0:75);let l=0,c=-i,d=0,m=-2*i;switch(this.nzGapPosition||("circle"===this.nzType?"top":"bottom")){case"left":l=-i,c=0,d=2*i,m=0;break;case"right":l=i,c=0,d=-2*i,m=0;break;case"bottom":c=i,m=2*i}this.pathString=`M 50,50 m ${l},${c}\n       a ${i},${i} 0 1 1 ${d},${-m}\n       a ${i},${i} 0 1 1 ${-d},${m}`,this.trailPathStyle={strokeDasharray:`${o-r}px ${o}px`,strokeDashoffset:`-${r/2}px`,transition:"stroke-dashoffset .3s ease 0s, stroke-dasharray .3s ease 0s, stroke .3s"},this.progressCirclePath=e.map((x,g)=>{const f=2===e.length&&0===g;return{stroke:this.isGradient&&!f?`url(#gradient-${this.gradientId})`:null,strokePathStyle:{stroke:this.isGradient?null:f?Et.get("success"):this.nzStrokeColor,transition:"stroke-dashoffset .3s ease 0s, stroke-dasharray .3s ease 0s, stroke .3s, stroke-width .06s ease .3s",strokeDasharray:`${(x||0)/100*(o-r)}px ${o}px`,strokeDashoffset:`-${r/2}px`}}}).reverse()}setStrokeColor(){const e=this.nzStrokeColor,i=this.isGradient=!!e&&"string"!=typeof e;i&&!this.isCircleStyle?this.lineGradient=(n=>{const{from:s="#1890ff",to:e="#1890ff",direction:i="to right",...a}=n;return 0!==Object.keys(a).length?`linear-gradient(${i}, ${it(a).map(({key:r,value:l})=>`${l} ${r}%`).join(", ")})`:`linear-gradient(${i}, ${s}, ${e})`})(e):i&&this.isCircleStyle?this.circleGradient=(n=>it(this.nzStrokeColor).map(({key:s,value:e})=>({offset:`${s}%`,color:e})))():(this.lineGradient=null,this.circleGradient=[])}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.sBO),t.Y36(N.jY),t.Y36(P.Is,8))},n.\u0275cmp=t.Xpm({type:n,selectors:[["nz-progress"]],inputs:{nzShowInfo:"nzShowInfo",nzWidth:"nzWidth",nzStrokeColor:"nzStrokeColor",nzSize:"nzSize",nzFormat:"nzFormat",nzSuccessPercent:"nzSuccessPercent",nzPercent:"nzPercent",nzStrokeWidth:"nzStrokeWidth",nzGapDegree:"nzGapDegree",nzStatus:"nzStatus",nzType:"nzType",nzGapPosition:"nzGapPosition",nzStrokeLinecap:"nzStrokeLinecap",nzSteps:"nzSteps"},exportAs:["nzProgress"],features:[t.TTD],decls:5,vars:17,consts:[["progressInfoTemplate",""],[3,"ngClass"],[4,"ngIf"],["class","ant-progress-inner",3,"width","height","fontSize","ant-progress-circle-gradient",4,"ngIf"],["class","ant-progress-text",4,"ngIf"],[1,"ant-progress-text"],[4,"ngIf","ngIfElse"],["formatTemplate",""],["nz-icon","",3,"nzType"],[4,"nzStringTemplateOutlet","nzStringTemplateOutletContext"],["class","ant-progress-steps-outer",4,"ngIf"],["class","ant-progress-outer",4,"ngIf"],[3,"ngTemplateOutlet"],[1,"ant-progress-outer"],[1,"ant-progress-inner"],[1,"ant-progress-bg"],["class","ant-progress-success-bg",3,"width","border-radius","height",4,"ngIf"],[1,"ant-progress-success-bg"],[1,"ant-progress-steps-outer"],["class","ant-progress-steps-item",3,"ngStyle",4,"ngFor","ngForOf"],[1,"ant-progress-steps-item",3,"ngStyle"],["viewBox","0 0 100 100",1,"ant-progress-circle"],["stroke","#f3f3f3","fill-opacity","0",1,"ant-progress-circle-trail",3,"ngStyle"],["class","ant-progress-circle-path","fill-opacity","0",3,"ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["x1","100%","y1","0%","x2","0%","y2","0%",3,"id"],[4,"ngFor","ngForOf"],["fill-opacity","0",1,"ant-progress-circle-path",3,"ngStyle"]],template:function(e,i){1&e&&(t.YNc(0,Tt,1,1,"ng-template",null,0,t.W1O),t.TgZ(2,"div",1),t.YNc(3,Ft,3,2,"div",2),t.YNc(4,Mt,6,15,"div",3),t.qZA()),2&e&&(t.xp6(2),t.ekj("ant-progress-line","line"===i.nzType)("ant-progress-small","small"===i.nzSize)("ant-progress-default","default"===i.nzSize)("ant-progress-show-info",i.nzShowInfo)("ant-progress-circle",i.isCircleStyle)("ant-progress-steps",i.isSteps)("ant-progress-rtl","rtl"===i.dir),t.Q6J("ngClass","ant-progress ant-progress-status-"+i.status),t.xp6(1),t.Q6J("ngIf","line"===i.nzType),t.xp6(1),t.Q6J("ngIf",i.isCircleStyle))},dependencies:[h.mk,h.sg,h.O5,h.tP,h.PC,T.Ls,nt.f],encapsulation:2,changeDetection:0}),(0,u.gn)([(0,N.oS)()],n.prototype,"nzShowInfo",void 0),(0,u.gn)([(0,N.oS)()],n.prototype,"nzStrokeColor",void 0),(0,u.gn)([(0,N.oS)()],n.prototype,"nzSize",void 0),(0,u.gn)([(0,z.Rn)()],n.prototype,"nzSuccessPercent",void 0),(0,u.gn)([(0,z.Rn)()],n.prototype,"nzPercent",void 0),(0,u.gn)([(0,N.oS)(),(0,z.Rn)()],n.prototype,"nzStrokeWidth",void 0),(0,u.gn)([(0,N.oS)(),(0,z.Rn)()],n.prototype,"nzGapDegree",void 0),(0,u.gn)([(0,N.oS)()],n.prototype,"nzGapPosition",void 0),(0,u.gn)([(0,N.oS)()],n.prototype,"nzStrokeLinecap",void 0),(0,u.gn)([(0,z.Rn)()],n.prototype,"nzSteps",void 0),n})(),Rt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[P.vT,h.ez,T.PV,nt.T]}),n})();var st=p(1279);const qt=["file"],Bt=["nz-upload-btn",""],at=["*"];function Gt(n,s){}const A=function(n){return{$implicit:n}};function Wt(n,s){if(1&n&&(t.TgZ(0,"div",18),t.YNc(1,Gt,0,0,"ng-template",19),t.qZA()),2&n){const e=t.oxw(2).$implicit,i=t.MAs(5);t.ekj("ant-upload-list-item-file",!e.isUploading),t.xp6(1),t.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",t.VKq(4,A,e))}}function jt(n,s){if(1&n&&t._UZ(0,"img",22),2&n){const e=t.oxw(3).$implicit;t.Q6J("src",e.thumbUrl||e.url,t.LSH),t.uIk("alt",e.name)}}function Ht(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"a",20),t.NdJ("click",function(a){t.CHM(e);const o=t.oxw(2).$implicit,r=t.oxw();return t.KtG(r.handlePreview(o,a))}),t.YNc(1,jt,1,2,"img",21),t.qZA()}if(2&n){t.oxw();const e=t.MAs(5),i=t.oxw().$implicit;t.ekj("ant-upload-list-item-file",!i.isImageUrl),t.Q6J("href",i.url||i.thumbUrl,t.LSH),t.xp6(1),t.Q6J("ngIf",i.isImageUrl)("ngIfElse",e)}}function Vt(n,s){}function Kt(n,s){if(1&n&&(t.TgZ(0,"div",23),t.YNc(1,Vt,0,0,"ng-template",19),t.qZA()),2&n){const e=t.oxw(2).$implicit,i=t.MAs(5);t.xp6(1),t.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",t.VKq(2,A,e))}}function Xt(n,s){}function te(n,s){if(1&n&&t.YNc(0,Xt,0,0,"ng-template",19),2&n){const e=t.oxw(2).$implicit,i=t.MAs(5);t.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",t.VKq(2,A,e))}}function ee(n,s){if(1&n&&(t.ynx(0,13),t.YNc(1,Wt,2,6,"div",14),t.YNc(2,Ht,2,5,"a",15),t.YNc(3,Kt,2,4,"div",16),t.BQk(),t.YNc(4,te,1,4,"ng-template",null,17,t.W1O)),2&n){const e=t.oxw().$implicit;t.Q6J("ngSwitch",e.iconType),t.xp6(1),t.Q6J("ngSwitchCase","uploading"),t.xp6(1),t.Q6J("ngSwitchCase","thumbnail")}}function ne(n,s){1&n&&(t.ynx(0),t._UZ(1,"span",29),t.BQk())}function ie(n,s){if(1&n&&(t.ynx(0),t.YNc(1,ne,2,0,"ng-container",24),t.BQk()),2&n){const e=t.oxw(2).$implicit,i=t.MAs(4);t.xp6(1),t.Q6J("ngIf",e.isUploading)("ngIfElse",i)}}function oe(n,s){if(1&n&&(t.ynx(0),t._uU(1),t.BQk()),2&n){const e=t.oxw(5);t.xp6(1),t.hij(" ",e.locale.uploading," ")}}function se(n,s){if(1&n&&(t.ynx(0),t.YNc(1,oe,2,1,"ng-container",24),t.BQk()),2&n){const e=t.oxw(2).$implicit,i=t.MAs(4);t.xp6(1),t.Q6J("ngIf",e.isUploading)("ngIfElse",i)}}function ae(n,s){if(1&n&&t._UZ(0,"span",30),2&n){const e=t.oxw(2).$implicit;t.Q6J("nzType",e.isUploading?"loading":"paper-clip")}}function re(n,s){if(1&n&&(t.ynx(0)(1,13),t.YNc(2,ie,2,2,"ng-container",27),t.YNc(3,se,2,2,"ng-container",27),t.YNc(4,ae,1,1,"span",28),t.BQk()()),2&n){const e=t.oxw(3);t.xp6(1),t.Q6J("ngSwitch",e.listType),t.xp6(1),t.Q6J("ngSwitchCase","picture"),t.xp6(1),t.Q6J("ngSwitchCase","picture-card")}}function le(n,s){}function pe(n,s){if(1&n&&t._UZ(0,"span",31),2&n){const e=t.oxw().$implicit;t.Q6J("nzType",e.isImageUrl?"picture":"file")}}function ce(n,s){if(1&n&&(t.YNc(0,re,5,3,"ng-container",24),t.YNc(1,le,0,0,"ng-template",19,25,t.W1O),t.YNc(3,pe,1,1,"ng-template",null,26,t.W1O)),2&n){const e=s.$implicit,i=t.MAs(2),a=t.oxw(2);t.Q6J("ngIf",!a.iconRender)("ngIfElse",i),t.xp6(1),t.Q6J("ngTemplateOutlet",a.iconRender)("ngTemplateOutletContext",t.VKq(4,A,e))}}function de(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"button",33),t.NdJ("click",function(a){t.CHM(e);const o=t.oxw(2).$implicit,r=t.oxw();return t.KtG(r.handleRemove(o,a))}),t._UZ(1,"span",34),t.qZA()}if(2&n){const e=t.oxw(3);t.uIk("title",e.locale.removeFile)}}function ge(n,s){if(1&n&&t.YNc(0,de,2,1,"button",32),2&n){const e=t.oxw(2);t.Q6J("ngIf",e.icons.showRemoveIcon)}}function me(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"button",33),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2).$implicit,o=t.oxw();return t.KtG(o.handleDownload(a))}),t._UZ(1,"span",35),t.qZA()}if(2&n){const e=t.oxw(3);t.uIk("title",e.locale.downloadFile)}}function _e(n,s){if(1&n&&t.YNc(0,me,2,1,"button",32),2&n){const e=t.oxw().$implicit;t.Q6J("ngIf",e.showDownload)}}function he(n,s){}function ue(n,s){}function fe(n,s){if(1&n&&(t.TgZ(0,"span"),t.YNc(1,he,0,0,"ng-template",10),t.YNc(2,ue,0,0,"ng-template",10),t.qZA()),2&n){t.oxw(2);const e=t.MAs(9),i=t.MAs(7),a=t.oxw();t.Gre("ant-upload-list-item-card-actions ","picture"===a.listType?"picture":"",""),t.xp6(1),t.Q6J("ngTemplateOutlet",e),t.xp6(1),t.Q6J("ngTemplateOutlet",i)}}function ze(n,s){if(1&n&&t.YNc(0,fe,3,5,"span",36),2&n){const e=t.oxw(2);t.Q6J("ngIf","picture-card"!==e.listType)}}function xe(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"a",39),t.NdJ("click",function(a){t.CHM(e);const o=t.oxw(2).$implicit,r=t.oxw();return t.KtG(r.handlePreview(o,a))}),t._uU(1),t.qZA()}if(2&n){const e=t.oxw(2).$implicit;t.Q6J("href",e.url,t.LSH),t.uIk("title",e.name)("download",e.linkProps&&e.linkProps.download),t.xp6(1),t.hij(" ",e.name," ")}}function Ce(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"span",40),t.NdJ("click",function(a){t.CHM(e);const o=t.oxw(2).$implicit,r=t.oxw();return t.KtG(r.handlePreview(o,a))}),t._uU(1),t.qZA()}if(2&n){const e=t.oxw(2).$implicit;t.uIk("title",e.name),t.xp6(1),t.hij(" ",e.name," ")}}function ye(n,s){}function Te(n,s){if(1&n&&(t.YNc(0,xe,2,4,"a",37),t.YNc(1,Ce,2,2,"span",38),t.YNc(2,ye,0,0,"ng-template",10)),2&n){const e=t.oxw().$implicit,i=t.MAs(11);t.Q6J("ngIf",e.url),t.xp6(1),t.Q6J("ngIf",!e.url),t.xp6(1),t.Q6J("ngTemplateOutlet",i)}}function ve(n,s){}function we(n,s){}const Ne=function(){return{opacity:.5,"pointer-events":"none"}};function Se(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"a",44),t.NdJ("click",function(a){t.CHM(e);const o=t.oxw(2).$implicit,r=t.oxw();return t.KtG(r.handlePreview(o,a))}),t._UZ(1,"span",45),t.qZA()}if(2&n){const e=t.oxw(2).$implicit,i=t.oxw();t.Q6J("href",e.url||e.thumbUrl,t.LSH)("ngStyle",e.url||e.thumbUrl?null:t.DdM(3,Ne)),t.uIk("title",i.locale.previewFile)}}function Ue(n,s){}function be(n,s){if(1&n&&(t.ynx(0),t.YNc(1,Ue,0,0,"ng-template",10),t.BQk()),2&n){t.oxw(2);const e=t.MAs(9);t.xp6(1),t.Q6J("ngTemplateOutlet",e)}}function Le(n,s){}function Fe(n,s){if(1&n&&(t.TgZ(0,"span",41),t.YNc(1,Se,2,4,"a",42),t.YNc(2,be,2,1,"ng-container",43),t.YNc(3,Le,0,0,"ng-template",10),t.qZA()),2&n){const e=t.oxw().$implicit,i=t.MAs(7),a=t.oxw();t.xp6(1),t.Q6J("ngIf",a.icons.showPreviewIcon),t.xp6(1),t.Q6J("ngIf","done"===e.status),t.xp6(1),t.Q6J("ngTemplateOutlet",i)}}function Ze(n,s){if(1&n&&(t.TgZ(0,"div",46),t._UZ(1,"nz-progress",47),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("nzPercent",e.percent)("nzShowInfo",!1)("nzStrokeWidth",2)}}function Ie(n,s){if(1&n&&(t.TgZ(0,"div")(1,"div",1),t.YNc(2,ee,6,3,"ng-template",null,2,t.W1O),t.YNc(4,ce,5,6,"ng-template",null,3,t.W1O),t.YNc(6,ge,1,1,"ng-template",null,4,t.W1O),t.YNc(8,_e,1,1,"ng-template",null,5,t.W1O),t.YNc(10,ze,1,1,"ng-template",null,6,t.W1O),t.YNc(12,Te,3,3,"ng-template",null,7,t.W1O),t.TgZ(14,"div",8)(15,"span",9),t.YNc(16,ve,0,0,"ng-template",10),t.YNc(17,we,0,0,"ng-template",10),t.qZA()(),t.YNc(18,Fe,4,3,"span",11),t.YNc(19,Ze,2,3,"div",12),t.qZA()()),2&n){const e=s.$implicit,i=t.MAs(3),a=t.MAs(13),o=t.oxw();t.Gre("ant-upload-list-",o.listType,"-container"),t.xp6(1),t.MT6("ant-upload-list-item ant-upload-list-item-",e.status," ant-upload-list-item-list-type-",o.listType,""),t.Q6J("@itemState",void 0)("nzTooltipTitle","error"===e.status?e.message:null),t.uIk("data-key",e.key),t.xp6(15),t.Q6J("ngTemplateOutlet",i),t.xp6(1),t.Q6J("ngTemplateOutlet",a),t.xp6(1),t.Q6J("ngIf","picture-card"===o.listType&&!e.isUploading),t.xp6(1),t.Q6J("ngIf",e.isUploading)}}const ke=["uploadComp"],Oe=["listComp"],Me=function(){return[]};function Pe(n,s){if(1&n&&t._UZ(0,"nz-upload-list",8,9),2&n){const e=t.oxw(2);t.Udp("display",e.nzShowUploadList?"":"none"),t.Q6J("locale",e.locale)("listType",e.nzListType)("items",e.nzFileList||t.DdM(13,Me))("icons",e.nzShowUploadList)("iconRender",e.nzIconRender)("previewFile",e.nzPreviewFile)("previewIsImage",e.nzPreviewIsImage)("onPreview",e.nzPreview)("onRemove",e.onRemove)("onDownload",e.nzDownload)("dir",e.dir)}}function Ae(n,s){1&n&&t.GkF(0)}function Je(n,s){if(1&n&&(t.ynx(0),t.YNc(1,Ae,1,0,"ng-container",10),t.BQk()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngTemplateOutlet",e.nzFileListRender)("ngTemplateOutletContext",t.VKq(2,A,e.nzFileList))}}function Qe(n,s){if(1&n&&(t.YNc(0,Pe,2,14,"nz-upload-list",6),t.YNc(1,Je,2,4,"ng-container",7)),2&n){const e=t.oxw();t.Q6J("ngIf",e.locale&&!e.nzFileListRender),t.xp6(1),t.Q6J("ngIf",e.nzFileListRender)}}function De(n,s){1&n&&t.Hsn(0)}function Ee(n,s){}function $e(n,s){if(1&n&&(t.TgZ(0,"div",11)(1,"div",12,13),t.YNc(3,Ee,0,0,"ng-template",14),t.qZA()()),2&n){const e=t.oxw(),i=t.MAs(3);t.Udp("display",e.nzShowButton?"":"none"),t.Q6J("ngClass",e.classList),t.xp6(1),t.Q6J("options",e._btnOptions),t.xp6(2),t.Q6J("ngTemplateOutlet",i)}}function Ye(n,s){}function Re(n,s){}function qe(n,s){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",15),t.NdJ("drop",function(a){t.CHM(e);const o=t.oxw();return t.KtG(o.fileDrop(a))})("dragover",function(a){t.CHM(e);const o=t.oxw();return t.KtG(o.fileDrop(a))})("dragleave",function(a){t.CHM(e);const o=t.oxw();return t.KtG(o.fileDrop(a))}),t.TgZ(2,"div",16,13)(4,"div",17),t.YNc(5,Ye,0,0,"ng-template",14),t.qZA()()(),t.YNc(6,Re,0,0,"ng-template",14),t.BQk()}if(2&n){const e=t.oxw(),i=t.MAs(3),a=t.MAs(1);t.xp6(1),t.Q6J("ngClass",e.classList),t.xp6(1),t.Q6J("options",e._btnOptions),t.xp6(3),t.Q6J("ngTemplateOutlet",i),t.xp6(1),t.Q6J("ngTemplateOutlet",a)}}function Be(n,s){}function Ge(n,s){}function We(n,s){if(1&n&&(t.ynx(0),t.YNc(1,Be,0,0,"ng-template",14),t.YNc(2,Ge,0,0,"ng-template",14),t.BQk()),2&n){t.oxw(2);const e=t.MAs(1),i=t.MAs(5);t.xp6(1),t.Q6J("ngTemplateOutlet",e),t.xp6(1),t.Q6J("ngTemplateOutlet",i)}}function je(n,s){if(1&n&&t.YNc(0,We,3,2,"ng-container",3),2&n){const e=t.oxw(),i=t.MAs(10);t.Q6J("ngIf","picture-card"===e.nzListType)("ngIfElse",i)}}function He(n,s){}function Ve(n,s){}function Ke(n,s){if(1&n&&(t.YNc(0,He,0,0,"ng-template",14),t.YNc(1,Ve,0,0,"ng-template",14)),2&n){t.oxw();const e=t.MAs(5),i=t.MAs(1);t.Q6J("ngTemplateOutlet",e),t.xp6(1),t.Q6J("ngTemplateOutlet",i)}}let Xe=(()=>{class n{constructor(e,i,a){if(this.ngZone=e,this.http=i,this.elementRef=a,this.reqs={},this.destroy=!1,this.destroy$=new $.x,!i)throw new Error("Not found 'HttpClient', You can import 'HttpClientModule' in your root module.")}onClick(){this.options.disabled||!this.options.openFileDialogOnClick||this.file.nativeElement.click()}onFileDrop(e){if(this.options.disabled||"dragover"===e.type)e.preventDefault();else{if(this.options.directory)this.traverseFileTree(e.dataTransfer.items);else{const i=Array.prototype.slice.call(e.dataTransfer.files).filter(a=>this.attrAccept(a,this.options.accept));i.length&&this.uploadFiles(i)}e.preventDefault()}}onChange(e){if(this.options.disabled)return;const i=e.target;this.uploadFiles(i.files),i.value=""}traverseFileTree(e){const i=(a,o)=>{a.isFile?a.file(r=>{this.attrAccept(r,this.options.accept)&&this.uploadFiles([r])}):a.isDirectory&&a.createReader().readEntries(l=>{for(const c of l)i(c,`${o}${a.name}/`)})};for(const a of e)i(a.webkitGetAsEntry(),"")}attrAccept(e,i){if(e&&i){const a=Array.isArray(i)?i:i.split(","),o=`${e.name}`,r=`${e.type}`,l=r.replace(/\/.*$/,"");return a.some(c=>{const d=c.trim();return"."===d.charAt(0)?-1!==o.toLowerCase().indexOf(d.toLowerCase(),o.toLowerCase().length-d.toLowerCase().length):/\/\*$/.test(d)?l===d.replace(/\/.*$/,""):r===d})}return!0}attachUid(e){return e.uid||(e.uid=Math.random().toString(36).substring(2)),e}uploadFiles(e){let i=(0,Z.of)(Array.prototype.slice.call(e));this.options.filters&&this.options.filters.forEach(a=>{i=i.pipe((0,M.w)(o=>{const r=a.fn(o);return r instanceof b.y?r:(0,Z.of)(r)}))}),i.subscribe(a=>{a.forEach(o=>{this.attachUid(o),this.upload(o,a)})},a=>{(0,j.ZK)("Unhandled upload filter error",a)})}upload(e,i){if(!this.options.beforeUpload)return this.post(e);const a=this.options.beforeUpload(e,i);if(a instanceof b.y)a.subscribe(o=>{const r=Object.prototype.toString.call(o);"[object File]"===r||"[object Blob]"===r?(this.attachUid(o),this.post(o)):"boolean"==typeof o&&!1!==o&&this.post(e)},o=>{(0,j.ZK)("Unhandled upload beforeUpload error",o)});else if(!1!==a)return this.post(e)}post(e){if(this.destroy)return;let a,i=(0,Z.of)(e);const o=this.options,{uid:r}=e,{action:l,data:c,headers:d,transformFile:m}=o,x={action:"string"==typeof l?l:"",name:o.name,headers:d,file:e,postFile:e,data:c,withCredentials:o.withCredentials,onProgress:o.onProgress?g=>{o.onProgress(g,e)}:void 0,onSuccess:(g,f)=>{this.clean(r),o.onSuccess(g,e,f)},onError:g=>{this.clean(r),o.onError(g,e)}};if("function"==typeof l){const g=l(e);g instanceof b.y?i=i.pipe((0,M.w)(()=>g),(0,R.U)(f=>(x.action=f,e))):x.action=g}if("function"==typeof m){const g=m(e);i=i.pipe((0,M.w)(()=>g instanceof b.y?g:(0,Z.of)(g)),(0,ht.b)(f=>a=f))}if("function"==typeof c){const g=c(e);g instanceof b.y?i=i.pipe((0,M.w)(()=>g),(0,R.U)(f=>(x.data=f,a??e))):x.data=g}if("function"==typeof d){const g=d(e);g instanceof b.y?i=i.pipe((0,M.w)(()=>g),(0,R.U)(f=>(x.headers=f,a??e))):x.headers=g}i.subscribe(g=>{x.postFile=g;const f=(o.customRequest||this.xhr).call(this,x);f instanceof tt.w0||(0,j.ZK)("Must return Subscription type in '[nzCustomRequest]' property"),this.reqs[r]=f,o.onStart(e)})}xhr(e){const i=new FormData;e.data&&Object.keys(e.data).map(o=>{i.append(o,e.data[o])}),i.append(e.name,e.postFile),e.headers||(e.headers={}),null!==e.headers["X-Requested-With"]?e.headers["X-Requested-With"]="XMLHttpRequest":delete e.headers["X-Requested-With"];const a=new O.aW("POST",e.action,i,{reportProgress:!0,withCredentials:e.withCredentials,headers:new O.WM(e.headers)});return this.http.request(a).subscribe(o=>{o.type===O.dt.UploadProgress?(o.total>0&&(o.percent=o.loaded/o.total*100),e.onProgress(o,e.file)):o instanceof O.Zn&&e.onSuccess(o.body,e.file,o)},o=>{this.abort(e.file),e.onError(o,e.file)})}clean(e){const i=this.reqs[e];i instanceof tt.w0&&i.unsubscribe(),delete this.reqs[e]}abort(e){e?this.clean(e&&e.uid):Object.keys(this.reqs).forEach(i=>this.clean(i))}ngOnInit(){this.ngZone.runOutsideAngular(()=>{(0,Y.R)(this.elementRef.nativeElement,"click").pipe((0,v.R)(this.destroy$)).subscribe(()=>this.onClick()),(0,Y.R)(this.elementRef.nativeElement,"keydown").pipe((0,v.R)(this.destroy$)).subscribe(e=>{this.options.disabled||("Enter"===e.key||e.keyCode===_t.K5)&&this.onClick()})})}ngOnDestroy(){this.destroy=!0,this.destroy$.next(),this.abort()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.R0b),t.Y36(O.eN,8),t.Y36(t.SBq))},n.\u0275cmp=t.Xpm({type:n,selectors:[["","nz-upload-btn",""]],viewQuery:function(e,i){if(1&e&&t.Gf(qt,7),2&e){let a;t.iGM(a=t.CRH())&&(i.file=a.first)}},hostAttrs:[1,"ant-upload"],hostVars:4,hostBindings:function(e,i){1&e&&t.NdJ("drop",function(o){return i.onFileDrop(o)})("dragover",function(o){return i.onFileDrop(o)}),2&e&&(t.uIk("tabindex","0")("role","button"),t.ekj("ant-upload-disabled",i.options.disabled))},inputs:{options:"options"},exportAs:["nzUploadBtn"],attrs:Bt,ngContentSelectors:at,decls:3,vars:4,consts:[["type","file",2,"display","none",3,"multiple","change"],["file",""]],template:function(e,i){1&e&&(t.F$t(),t.TgZ(0,"input",0,1),t.NdJ("change",function(o){return i.onChange(o)}),t.qZA(),t.Hsn(2)),2&e&&(t.Q6J("multiple",i.options.multiple),t.uIk("accept",i.options.accept)("directory",i.options.directory?"directory":null)("webkitdirectory",i.options.directory?"webkitdirectory":null))},encapsulation:2}),n})();const rt=n=>!!n&&0===n.indexOf("image/"),S=200;let tn=(()=>{class n{constructor(e,i,a,o){this.cdr=e,this.doc=i,this.ngZone=a,this.platform=o,this.list=[],this.locale={},this.iconRender=null,this.dir="ltr",this.destroy$=new $.x}get showPic(){return"picture"===this.listType||"picture-card"===this.listType}set items(e){this.list=e}genErr(e){return e.response&&"string"==typeof e.response?e.response:e.error&&e.error.statusText||this.locale.uploadError}extname(e){const i=e.split("/"),o=i[i.length-1].split(/#|\?/)[0];return(/\.[^./\\]*$/.exec(o)||[""])[0]}isImageUrl(e){if(rt(e.type))return!0;const i=e.thumbUrl||e.url||"";if(!i)return!1;const a=this.extname(i);return!(!/^data:image\//.test(i)&&!/(webp|svg|png|gif|jpg|jpeg|jfif|bmp|dpg)$/i.test(a))||!/^data:/.test(i)&&!a}getIconType(e){return this.showPic?e.isUploading||!e.thumbUrl&&!e.url?"uploading":"thumbnail":""}previewImage(e){if(!rt(e.type)||!this.platform.isBrowser)return(0,Z.of)("");const i=this.doc.createElement("canvas");i.width=S,i.height=S,i.style.cssText="position: fixed; left: 0; top: 0; width: 200px; height: 200px; z-index: 9999; display: none;",this.doc.body.appendChild(i);const a=i.getContext("2d"),o=new Image,r=URL.createObjectURL(e);return o.src=r,(0,Y.R)(o,"load").pipe((0,R.U)(()=>{const{width:l,height:c}=o;let d=S,m=S,x=0,g=0;l<c?(m=c*(S/l),g=-(m-d)/2):(d=l*(S/c),x=-(d-m)/2);try{a.drawImage(o,x,g,d,m)}catch{}const f=i.toDataURL();return this.doc.body.removeChild(i),URL.revokeObjectURL(r),f}))}genThumb(){if(!this.platform.isBrowser)return;const e=window;!this.showPic||typeof document>"u"||typeof e>"u"||!e.FileReader||!e.File||this.list.filter(i=>i.originFileObj instanceof File&&void 0===i.thumbUrl).forEach(i=>{i.thumbUrl="";const a=(this.previewFile?this.previewFile(i):this.previewImage(i.originFileObj)).pipe((0,v.R)(this.destroy$));this.ngZone.runOutsideAngular(()=>{a.subscribe(o=>{this.ngZone.run(()=>{i.thumbUrl=o,this.detectChanges()})})})})}showDownload(e){return!(!this.icons.showDownloadIcon||"done"!==e.status)}fixData(){this.list.forEach(e=>{e.isUploading="uploading"===e.status,e.message=this.genErr(e),e.linkProps="string"==typeof e.linkProps?JSON.parse(e.linkProps):e.linkProps,e.isImageUrl=this.previewIsImage?this.previewIsImage(e):this.isImageUrl(e),e.iconType=this.getIconType(e),e.showDownload=this.showDownload(e)})}handlePreview(e,i){if(this.onPreview)return i.preventDefault(),this.onPreview(e)}handleRemove(e,i){i.preventDefault(),this.onRemove&&this.onRemove(e)}handleDownload(e){"function"==typeof this.onDownload?this.onDownload(e):e.url&&window.open(e.url)}detectChanges(){this.fixData(),this.cdr.detectChanges()}ngOnChanges(){this.fixData(),this.genThumb()}ngOnDestroy(){this.destroy$.next()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.sBO),t.Y36(h.K0),t.Y36(t.R0b),t.Y36(et.t4))},n.\u0275cmp=t.Xpm({type:n,selectors:[["nz-upload-list"]],hostAttrs:[1,"ant-upload-list"],hostVars:8,hostBindings:function(e,i){2&e&&t.ekj("ant-upload-list-rtl","rtl"===i.dir)("ant-upload-list-text","text"===i.listType)("ant-upload-list-picture","picture"===i.listType)("ant-upload-list-picture-card","picture-card"===i.listType)},inputs:{locale:"locale",listType:"listType",items:"items",icons:"icons",onPreview:"onPreview",onRemove:"onRemove",onDownload:"onDownload",previewFile:"previewFile",previewIsImage:"previewIsImage",iconRender:"iconRender",dir:"dir"},exportAs:["nzUploadList"],features:[t.TTD],decls:1,vars:1,consts:[[3,"class",4,"ngFor","ngForOf"],["nz-tooltip","",3,"nzTooltipTitle"],["icon",""],["iconNode",""],["removeIcon",""],["downloadIcon",""],["downloadOrDelete",""],["preview",""],[1,"ant-upload-list-item-info"],[1,"ant-upload-span"],[3,"ngTemplateOutlet"],["class","ant-upload-list-item-actions",4,"ngIf"],["class","ant-upload-list-item-progress",4,"ngIf"],[3,"ngSwitch"],["class","ant-upload-list-item-thumbnail",3,"ant-upload-list-item-file",4,"ngSwitchCase"],["class","ant-upload-list-item-thumbnail","target","_blank","rel","noopener noreferrer",3,"ant-upload-list-item-file","href","click",4,"ngSwitchCase"],["class","ant-upload-text-icon",4,"ngSwitchDefault"],["noImageThumbTpl",""],[1,"ant-upload-list-item-thumbnail"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["target","_blank","rel","noopener noreferrer",1,"ant-upload-list-item-thumbnail",3,"href","click"],["class","ant-upload-list-item-image",3,"src",4,"ngIf","ngIfElse"],[1,"ant-upload-list-item-image",3,"src"],[1,"ant-upload-text-icon"],[4,"ngIf","ngIfElse"],["customIconRender",""],["iconNodeFileIcon",""],[4,"ngSwitchCase"],["nz-icon","",3,"nzType",4,"ngSwitchDefault"],["nz-icon","","nzType","loading"],["nz-icon","",3,"nzType"],["nz-icon","","nzTheme","twotone",3,"nzType"],["type","button","nz-button","","nzType","text","nzSize","small","class","ant-upload-list-item-card-actions-btn",3,"click",4,"ngIf"],["type","button","nz-button","","nzType","text","nzSize","small",1,"ant-upload-list-item-card-actions-btn",3,"click"],["nz-icon","","nzType","delete"],["nz-icon","","nzType","download"],[3,"class",4,"ngIf"],["target","_blank","rel","noopener noreferrer","class","ant-upload-list-item-name",3,"href","click",4,"ngIf"],["class","ant-upload-list-item-name",3,"click",4,"ngIf"],["target","_blank","rel","noopener noreferrer",1,"ant-upload-list-item-name",3,"href","click"],[1,"ant-upload-list-item-name",3,"click"],[1,"ant-upload-list-item-actions"],["target","_blank","rel","noopener noreferrer",3,"href","ngStyle","click",4,"ngIf"],[4,"ngIf"],["target","_blank","rel","noopener noreferrer",3,"href","ngStyle","click"],["nz-icon","","nzType","eye"],[1,"ant-upload-list-item-progress"],["nzType","line",3,"nzPercent","nzShowInfo","nzStrokeWidth"]],template:function(e,i){1&e&&t.YNc(0,Ie,20,14,"div",0),2&e&&t.Q6J("ngForOf",i.list)},dependencies:[h.sg,h.O5,h.tP,h.PC,h.RF,h.n9,h.ED,k.SY,Yt,T.Ls,F.ix,D.w],encapsulation:2,data:{animation:[(0,w.X$)("itemState",[(0,w.eR)(":enter",[(0,w.oB)({height:"0",width:"0",opacity:0}),(0,w.jt)(150,(0,w.oB)({height:"*",width:"*",opacity:1}))]),(0,w.eR)(":leave",[(0,w.jt)(150,(0,w.oB)({height:"0",width:"0",opacity:0}))])])]},changeDetection:0}),n})(),en=(()=>{class n{constructor(e,i,a,o,r){this.ngZone=e,this.document=i,this.cdr=a,this.i18n=o,this.directionality=r,this.destroy$=new $.x,this.dir="ltr",this.nzType="select",this.nzLimit=0,this.nzSize=0,this.nzDirectory=!1,this.nzOpenFileDialogOnClick=!0,this.nzFilter=[],this.nzFileList=[],this.nzDisabled=!1,this.nzListType="text",this.nzMultiple=!1,this.nzName="file",this._showUploadList=!0,this.nzShowButton=!0,this.nzWithCredentials=!1,this.nzIconRender=null,this.nzFileListRender=null,this.nzChange=new t.vpe,this.nzFileListChange=new t.vpe,this.onStart=l=>{this.nzFileList||(this.nzFileList=[]);const c=this.fileToObject(l);c.status="uploading",this.nzFileList=this.nzFileList.concat(c),this.nzFileListChange.emit(this.nzFileList),this.nzChange.emit({file:c,fileList:this.nzFileList,type:"start"}),this.detectChangesList()},this.onProgress=(l,c)=>{const m=this.getFileItem(c,this.nzFileList);m.percent=l.percent,this.nzChange.emit({event:l,file:{...m},fileList:this.nzFileList,type:"progress"}),this.detectChangesList()},this.onSuccess=(l,c)=>{const d=this.nzFileList,m=this.getFileItem(c,d);m.status="done",m.response=l,this.nzChange.emit({file:{...m},fileList:d,type:"success"}),this.detectChangesList()},this.onError=(l,c)=>{const d=this.nzFileList,m=this.getFileItem(c,d);m.error=l,m.status="error",this.nzChange.emit({file:{...m},fileList:d,type:"error"}),this.detectChangesList()},this.onRemove=l=>{this.uploadComp.abort(l),l.status="removed";const c="function"==typeof this.nzRemove?this.nzRemove(l):null==this.nzRemove||this.nzRemove;(c instanceof b.y?c:(0,Z.of)(c)).pipe((0,ut.h)(d=>d)).subscribe(()=>{this.nzFileList=this.removeFileItem(l,this.nzFileList),this.nzChange.emit({file:l,fileList:this.nzFileList,type:"removed"}),this.nzFileListChange.emit(this.nzFileList),this.cdr.detectChanges()})},this.prefixCls="ant-upload",this.classList=[]}set nzShowUploadList(e){this._showUploadList="boolean"==typeof e?(0,z.sw)(e):e}get nzShowUploadList(){return this._showUploadList}zipOptions(){"boolean"==typeof this.nzShowUploadList&&this.nzShowUploadList&&(this.nzShowUploadList={showPreviewIcon:!0,showRemoveIcon:!0,showDownloadIcon:!0});const e=this.nzFilter.slice();if(this.nzMultiple&&this.nzLimit>0&&-1===e.findIndex(i=>"limit"===i.name)&&e.push({name:"limit",fn:i=>i.slice(-this.nzLimit)}),this.nzSize>0&&-1===e.findIndex(i=>"size"===i.name)&&e.push({name:"size",fn:i=>i.filter(a=>a.size/1024<=this.nzSize)}),this.nzFileType&&this.nzFileType.length>0&&-1===e.findIndex(i=>"type"===i.name)){const i=this.nzFileType.split(",");e.push({name:"type",fn:a=>a.filter(o=>~i.indexOf(o.type))})}return this._btnOptions={disabled:this.nzDisabled,accept:this.nzAccept,action:this.nzAction,directory:this.nzDirectory,openFileDialogOnClick:this.nzOpenFileDialogOnClick,beforeUpload:this.nzBeforeUpload,customRequest:this.nzCustomRequest,data:this.nzData,headers:this.nzHeaders,name:this.nzName,multiple:this.nzMultiple,withCredentials:this.nzWithCredentials,filters:e,transformFile:this.nzTransformFile,onStart:this.onStart,onProgress:this.onProgress,onSuccess:this.onSuccess,onError:this.onError},this}fileToObject(e){return{lastModified:e.lastModified,lastModifiedDate:e.lastModifiedDate,name:e.filename||e.name,size:e.size,type:e.type,uid:e.uid,response:e.response,error:e.error,percent:0,originFileObj:e}}getFileItem(e,i){return i.filter(a=>a.uid===e.uid)[0]}removeFileItem(e,i){return i.filter(a=>a.uid!==e.uid)}fileDrop(e){e.type!==this.dragState&&(this.dragState=e.type,this.setClassMap())}detectChangesList(){this.cdr.detectChanges(),this.listComp?.detectChanges()}setClassMap(){let e=[];"drag"===this.nzType?(this.nzFileList.some(i=>"uploading"===i.status)&&e.push(`${this.prefixCls}-drag-uploading`),"dragover"===this.dragState&&e.push(`${this.prefixCls}-drag-hover`)):e=[`${this.prefixCls}-select-${this.nzListType}`],this.classList=[this.prefixCls,`${this.prefixCls}-${this.nzType}`,...e,this.nzDisabled&&`${this.prefixCls}-disabled`||"","rtl"===this.dir&&`${this.prefixCls}-rtl`||""].filter(i=>!!i),this.cdr.detectChanges()}ngOnInit(){this.dir=this.directionality.value,this.directionality.change?.pipe((0,v.R)(this.destroy$)).subscribe(e=>{this.dir=e,this.setClassMap(),this.cdr.detectChanges()}),this.i18n.localeChange.pipe((0,v.R)(this.destroy$)).subscribe(()=>{this.locale=this.i18n.getLocaleData("Upload"),this.detectChangesList()})}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>(0,Y.R)(this.document.body,"drop").pipe((0,v.R)(this.destroy$)).subscribe(e=>{e.preventDefault(),e.stopPropagation()}))}ngOnChanges(){this.zipOptions().setClassMap()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.R0b),t.Y36(h.K0),t.Y36(t.sBO),t.Y36(st.wi),t.Y36(P.Is,8))},n.\u0275cmp=t.Xpm({type:n,selectors:[["nz-upload"]],viewQuery:function(e,i){if(1&e&&(t.Gf(ke,5),t.Gf(Oe,5)),2&e){let a;t.iGM(a=t.CRH())&&(i.uploadComp=a.first),t.iGM(a=t.CRH())&&(i.listComp=a.first)}},hostVars:2,hostBindings:function(e,i){2&e&&t.ekj("ant-upload-picture-card-wrapper","picture-card"===i.nzListType)},inputs:{nzType:"nzType",nzLimit:"nzLimit",nzSize:"nzSize",nzFileType:"nzFileType",nzAccept:"nzAccept",nzAction:"nzAction",nzDirectory:"nzDirectory",nzOpenFileDialogOnClick:"nzOpenFileDialogOnClick",nzBeforeUpload:"nzBeforeUpload",nzCustomRequest:"nzCustomRequest",nzData:"nzData",nzFilter:"nzFilter",nzFileList:"nzFileList",nzDisabled:"nzDisabled",nzHeaders:"nzHeaders",nzListType:"nzListType",nzMultiple:"nzMultiple",nzName:"nzName",nzShowUploadList:"nzShowUploadList",nzShowButton:"nzShowButton",nzWithCredentials:"nzWithCredentials",nzRemove:"nzRemove",nzPreview:"nzPreview",nzPreviewFile:"nzPreviewFile",nzPreviewIsImage:"nzPreviewIsImage",nzTransformFile:"nzTransformFile",nzDownload:"nzDownload",nzIconRender:"nzIconRender",nzFileListRender:"nzFileListRender"},outputs:{nzChange:"nzChange",nzFileListChange:"nzFileListChange"},exportAs:["nzUpload"],features:[t.TTD],ngContentSelectors:at,decls:11,vars:2,consts:[["list",""],["con",""],["btn",""],[4,"ngIf","ngIfElse"],["select",""],["pic",""],[3,"display","locale","listType","items","icons","iconRender","previewFile","previewIsImage","onPreview","onRemove","onDownload","dir",4,"ngIf"],[4,"ngIf"],[3,"locale","listType","items","icons","iconRender","previewFile","previewIsImage","onPreview","onRemove","onDownload","dir"],["listComp",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngClass"],["nz-upload-btn","",3,"options"],["uploadComp",""],[3,"ngTemplateOutlet"],[3,"ngClass","drop","dragover","dragleave"],["nz-upload-btn","",1,"ant-upload-btn",3,"options"],[1,"ant-upload-drag-container"]],template:function(e,i){if(1&e&&(t.F$t(),t.YNc(0,Qe,2,2,"ng-template",null,0,t.W1O),t.YNc(2,De,1,0,"ng-template",null,1,t.W1O),t.YNc(4,$e,4,5,"ng-template",null,2,t.W1O),t.YNc(6,qe,7,4,"ng-container",3),t.YNc(7,je,1,2,"ng-template",null,4,t.W1O),t.YNc(9,Ke,2,2,"ng-template",null,5,t.W1O)),2&e){const a=t.MAs(8);t.xp6(6),t.Q6J("ngIf","drag"===i.nzType)("ngIfElse",a)}},dependencies:[P.Lv,h.mk,h.O5,h.tP,Xe,tn],encapsulation:2,changeDetection:0}),(0,u.gn)([(0,z.Rn)()],n.prototype,"nzLimit",void 0),(0,u.gn)([(0,z.Rn)()],n.prototype,"nzSize",void 0),(0,u.gn)([(0,z.yF)()],n.prototype,"nzDirectory",void 0),(0,u.gn)([(0,z.yF)()],n.prototype,"nzOpenFileDialogOnClick",void 0),(0,u.gn)([(0,z.yF)()],n.prototype,"nzDisabled",void 0),(0,u.gn)([(0,z.yF)()],n.prototype,"nzMultiple",void 0),(0,u.gn)([(0,z.yF)()],n.prototype,"nzShowButton",void 0),(0,u.gn)([(0,z.yF)()],n.prototype,"nzWithCredentials",void 0),n})(),nn=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[P.vT,h.ez,_.u5,et.ud,k.cg,Rt,st.YI,T.PV,F.sL]}),n})();function on(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",25)(1,"i",26),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.onCancel())}),t.qZA(),t.TgZ(2,"span",27),t._uU(3),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(3),t.Oqu(e.isEditMode?"Edit Expense":"Add New Expense")}}function sn(n,s){if(1&n&&t._UZ(0,"nz-option",28),2&n){const e=s.$implicit;t.Q6J("nzValue",e._id)("nzLabel",e.name)}}function an(n,s){if(1&n&&t._UZ(0,"nz-option",28),2&n){const e=s.$implicit;t.Q6J("nzValue",e)("nzLabel",e)}}function rn(n,s){if(1&n&&(t.TgZ(0,"div",29),t._UZ(1,"i",30),t.TgZ(2,"a",31),t._uU(3,"View Existing Receipt"),t.qZA()()),2&n){const e=t.oxw();t.xp6(2),t.Q6J("href",e.existingReceiptUrl,t.LSH)}}let lt=(()=>{const s=class{constructor(i,a,o,r,l){this.fb=i,this.route=a,this.router=o,this.appService=r,this.message=l,this.isEditMode=!1,this.expenseId=null,this.categories=[],this.loading=!1,this.paymentMethods=["Cash","UPI","Bank Transfer","Card","Other"],this.fileList=[],this.existingReceiptUrl=null,this.beforeUpload=c=>(this.fileList=this.fileList.concat(c),this.fileList.length>1&&(this.fileList=[c]),!1),this.removeFile=c=>(this.fileList=[],!0)}ngOnInit(){this.expenseForm=this.fb.group({date:[new Date,[_.kI.required]],category:[null,[_.kI.required]],amount:[null,[_.kI.required,_.kI.min(0)]],description:["",[_.kI.required]],paymentMethod:["Cash",[_.kI.required]]}),this.loadCategories(),this.route.paramMap.subscribe(i=>{this.expenseId=i.get("id"),this.expenseId&&(this.isEditMode=!0,this.loadExpense(this.expenseId))})}loadCategories(){this.appService.getExpenseCategories().subscribe(i=>this.categories=i)}loadExpense(i){this.loading=!0,this.appService.getExpenseById(i).subscribe({next:a=>{this.patchForm(a),this.loading=!1},error:()=>{this.message.error("Expense not found"),this.router.navigate(["/expenses/all"])}})}patchForm(i){if(this.expenseForm.patchValue({date:new Date(i.date),category:i.category?._id||i.category,amount:i.amount,description:i.description,paymentMethod:i.paymentMethod}),i.receiptUrl){const a=this.appService.apiEndPoint.replace(/\/api\/?$/,"");this.existingReceiptUrl=`${a}${i.receiptUrl}`}}submitForm(){if(this.expenseForm.valid){this.loading=!0;const i=new FormData,a=this.expenseForm.value;Object.keys(a).forEach(o=>{let r=a[o];"date"===o&&r instanceof Date&&(r=r.toISOString()),i.append(o,r)}),this.fileList.length>0&&i.append("receipt",this.fileList[0]),this.isEditMode&&this.expenseId?this.appService.updateExpense(this.expenseId,i).subscribe({next:()=>{this.message.success("Expense updated"),this.router.navigate(["/expenses/all"])},error:o=>{this.message.error(o.error?.message||"Failed to update expense"),this.loading=!1}}):this.appService.addExpense(i).subscribe({next:()=>{this.message.success("Expense added"),this.router.navigate(["/expenses/all"])},error:o=>{this.message.error(o.error?.message||"Failed to add expense"),this.loading=!1}})}else Object.values(this.expenseForm.controls).forEach(i=>{i.invalid&&(i.markAsDirty(),i.updateValueAndValidity({onlySelf:!0}))})}onCancel(){this.router.navigate(["/expenses/all"])}};let n=s;return s.\u0275fac=function(a){return new(a||s)(t.Y36(_.qu),t.Y36(L.gz),t.Y36(L.F0),t.Y36(q.z),t.Y36(J.dD))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-expense-form"]],decls:52,vars:24,consts:[[3,"nzTitle"],["titleTemplate",""],["nz-form","","nzLayout","vertical",3,"formGroup"],["nz-row","",3,"nzGutter"],["nz-col","",3,"nzXs","nzMd"],["nzRequired",""],["nzErrorTip","Please select date"],["formControlName","date",2,"width","100%"],["nzErrorTip","Please enter amount"],["formControlName","amount","nzPlaceHolder","Enter amount",2,"width","100%",3,"nzMin","nzStep"],["nzErrorTip","Please select category"],["formControlName","category","nzPlaceHolder","Select Category","nzShowSearch",""],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["nzErrorTip","Please select payment method"],["formControlName","paymentMethod","nzPlaceHolder","Select Payment Method"],["nz-col","",3,"nzXs"],[3,"nzFileList","nzBeforeUpload","nzRemove","nzLimit","nzFileListChange"],["nz-button",""],["nz-icon","","nzType","upload"],["style","margin-top: 8px;",4,"ngIf"],["nzErrorTip","Please enter description"],["nz-input","","formControlName","description","rows","3","placeholder","Expense details"],[2,"text-align","right","margin-top","16px"],["nz-button","","nzType","default",2,"margin-right","8px",3,"click"],["nz-button","","nzType","primary",3,"nzLoading","click"],[2,"display","flex","align-items","center"],["nz-icon","","nzType","arrow-left","nzTheme","outline","nz-tooltip","Back to Expenses",2,"cursor","pointer","margin-right","16px","font-size","18px",3,"click"],[2,"font-size","18px","font-weight","bold"],[3,"nzValue","nzLabel"],[2,"margin-top","8px"],["nz-icon","","nzType","paper-clip",2,"margin-right","8px"],["target","_blank",3,"href"]],template:function(a,o){if(1&a&&(t.TgZ(0,"nz-card",0),t.YNc(1,on,4,1,"ng-template",null,1,t.W1O),t.TgZ(3,"form",2)(4,"div",3)(5,"div",4)(6,"nz-form-item")(7,"nz-form-label",5),t._uU(8,"Date"),t.qZA(),t.TgZ(9,"nz-form-control",6),t._UZ(10,"nz-date-picker",7),t.qZA()()(),t.TgZ(11,"div",4)(12,"nz-form-item")(13,"nz-form-label",5),t._uU(14,"Amount (\u20b9)"),t.qZA(),t.TgZ(15,"nz-form-control",8),t._UZ(16,"nz-input-number",9),t.qZA()()(),t.TgZ(17,"div",4)(18,"nz-form-item")(19,"nz-form-label",5),t._uU(20,"Category"),t.qZA(),t.TgZ(21,"nz-form-control",10)(22,"nz-select",11),t.YNc(23,sn,1,2,"nz-option",12),t.qZA()()()(),t.TgZ(24,"div",4)(25,"nz-form-item")(26,"nz-form-label",5),t._uU(27,"Payment Method"),t.qZA(),t.TgZ(28,"nz-form-control",13)(29,"nz-select",14),t.YNc(30,an,1,2,"nz-option",12),t.qZA()()()(),t.TgZ(31,"div",15)(32,"nz-form-item")(33,"nz-form-label"),t._uU(34,"Receipt / Bill (Optional)"),t.qZA(),t.TgZ(35,"nz-form-control")(36,"nz-upload",16),t.NdJ("nzFileListChange",function(l){return o.fileList=l}),t.TgZ(37,"button",17),t._UZ(38,"i",18),t._uU(39," Select File (PDF/Image) "),t.qZA()(),t.YNc(40,rn,4,1,"div",19),t.qZA()()(),t.TgZ(41,"div",15)(42,"nz-form-item")(43,"nz-form-label",5),t._uU(44,"Description"),t.qZA(),t.TgZ(45,"nz-form-control",20),t._UZ(46,"textarea",21),t.qZA()()()(),t.TgZ(47,"div",22)(48,"button",23),t.NdJ("click",function(){return o.onCancel()}),t._uU(49,"Cancel"),t.qZA(),t.TgZ(50,"button",24),t.NdJ("click",function(){return o.submitForm()}),t._uU(51),t.qZA()()()()),2&a){const r=t.MAs(2);t.Q6J("nzTitle",r),t.xp6(3),t.Q6J("formGroup",o.expenseForm),t.xp6(1),t.Q6J("nzGutter",24),t.xp6(1),t.Q6J("nzXs",24)("nzMd",12),t.xp6(6),t.Q6J("nzXs",24)("nzMd",12),t.xp6(5),t.Q6J("nzMin",0)("nzStep",1),t.xp6(1),t.Q6J("nzXs",24)("nzMd",12),t.xp6(6),t.Q6J("ngForOf",o.categories),t.xp6(1),t.Q6J("nzXs",24)("nzMd",12),t.xp6(6),t.Q6J("ngForOf",o.paymentMethods),t.xp6(1),t.Q6J("nzXs",24),t.xp6(5),t.Q6J("nzFileList",o.fileList)("nzBeforeUpload",o.beforeUpload)("nzRemove",o.removeFile)("nzLimit",1),t.xp6(4),t.Q6J("ngIf",o.existingReceiptUrl&&0===o.fileList.length),t.xp6(1),t.Q6J("nzXs",24),t.xp6(9),t.Q6J("nzLoading",o.loading),t.xp6(1),t.hij(" ",o.isEditMode?"Update Expense":"Save Expense"," ")}},dependencies:[h.sg,h.O5,_._Y,_.Fj,_.JJ,_.JL,_.sg,_.u,Q.bd,F.ix,D.w,B.dQ,T.Ls,W.Zp,U.t3,U.SK,y.Lr,y.Nx,y.iK,y.Fd,I.Ip,I.Vq,k.SY,E.uw,X._V,en]}),n})();var H=p(3910);function ln(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",11)(1,"i",12),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.goBack())}),t.qZA(),t.TgZ(2,"span",13),t._uU(3,"Expense Categories"),t.qZA()()}}function pn(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"tr")(1,"td")(2,"strong"),t._uU(3),t.qZA()(),t.TgZ(4,"td"),t._uU(5),t.qZA(),t.TgZ(6,"td")(7,"button",14),t.NdJ("click",function(){const o=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.showEditModal(o))}),t._UZ(8,"i",15),t.qZA(),t.TgZ(9,"button",16),t.NdJ("nzOnConfirm",function(){const o=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.deleteCategory(o._id))}),t._UZ(10,"i",17),t.qZA()()()}if(2&n){const e=s.$implicit;t.xp6(3),t.Oqu(e.name),t.xp6(2),t.Oqu(e.description||"-")}}function cn(n,s){if(1&n&&(t.ynx(0),t.TgZ(1,"form",18)(2,"nz-form-item")(3,"nz-form-label",19),t._uU(4,"Category Name"),t.qZA(),t.TgZ(5,"nz-form-control",20),t._UZ(6,"input",21),t.qZA()(),t.TgZ(7,"nz-form-item")(8,"nz-form-label"),t._uU(9,"Description"),t.qZA(),t.TgZ(10,"nz-form-control"),t._UZ(11,"textarea",22),t.qZA()()(),t.BQk()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("formGroup",e.categoryForm)}}const dn=[{path:"categories",component:(()=>{const s=class{constructor(i,a,o,r){this.appService=i,this.message=a,this.fb=o,this.router=r,this.categories=[],this.loading=!1,this.isModalVisible=!1,this.modalLoading=!1,this.isEditing=!1,this.editingId=null}ngOnInit(){this.categoryForm=this.fb.group({name:["",[_.kI.required]],description:[""]}),this.loadCategories()}loadCategories(){this.loading=!0,this.appService.getExpenseCategories().subscribe({next:i=>{this.categories=i,this.loading=!1},error:()=>{this.message.error("Failed to load categories"),this.loading=!1}})}showAddModal(){this.isEditing=!1,this.editingId=null,this.categoryForm.reset(),this.isModalVisible=!0}showEditModal(i){this.isEditing=!0,this.editingId=i._id,this.categoryForm.patchValue({name:i.name,description:i.description}),this.isModalVisible=!0}handleCancel(){this.isModalVisible=!1,this.categoryForm.reset()}handleOk(){if(this.categoryForm.valid){this.modalLoading=!0;const i=this.categoryForm.value;this.isEditing&&this.editingId?this.appService.updateExpenseCategory(this.editingId,i).subscribe({next:()=>{this.message.success("Category updated"),this.isModalVisible=!1,this.modalLoading=!1,this.loadCategories()},error:a=>{this.message.error(a.error?.message||"Failed to update category"),this.modalLoading=!1}}):this.appService.addExpenseCategory(i).subscribe({next:()=>{this.message.success("Category added"),this.isModalVisible=!1,this.modalLoading=!1,this.loadCategories()},error:a=>{this.message.error(a.error?.message||"Failed to add category"),this.modalLoading=!1}})}else Object.values(this.categoryForm.controls).forEach(i=>{i.invalid&&(i.markAsDirty(),i.updateValueAndValidity({onlySelf:!0}))})}deleteCategory(i){this.appService.deleteExpenseCategory(i).subscribe({next:()=>{this.message.success("Category deleted"),this.loadCategories()},error:a=>{this.message.error(a.error?.message||"Failed to delete category")}})}goBack(){this.router.navigate(["/expenses"])}};let n=s;return s.\u0275fac=function(a){return new(a||s)(t.Y36(q.z),t.Y36(J.dD),t.Y36(_.qu),t.Y36(L.F0))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-category-manager"]],decls:21,vars:8,consts:[[3,"nzTitle"],["titleTemplate",""],[2,"margin-bottom","16px","text-align","right"],["nz-button","","nzType","primary",3,"click"],["nz-icon","","nzType","plus"],[3,"nzData","nzLoading","nzPageSize"],["categoryTable",""],["nzWidth","120px"],[4,"ngFor","ngForOf"],[3,"nzVisible","nzTitle","nzOkLoading","nzVisibleChange","nzOnCancel","nzOnOk"],[4,"nzModalContent"],[2,"display","flex","align-items","center"],["nz-icon","","nzType","arrow-left","nzTheme","outline","nz-tooltip","Back to Expenses",2,"cursor","pointer","margin-right","16px","font-size","18px",3,"click"],[2,"font-size","18px","font-weight","bold"],["nz-button","","nzType","text",3,"click"],["nz-icon","","nzType","edit","nzTheme","outline",2,"color","#1890ff"],["nz-button","","nzType","text","nz-popconfirm","","nzPopconfirmTitle","Sure to delete?",3,"nzOnConfirm"],["nz-icon","","nzType","delete","nzTheme","outline",2,"color","#ff4d4f"],["nz-form","","nzLayout","vertical",3,"formGroup"],["nzRequired",""],["nzErrorTip","Please enter name"],["nz-input","","formControlName","name","placeholder","E.g. Rent, Utilities"],["nz-input","","formControlName","description","placeholder","Description (Optional)","rows","3"]],template:function(a,o){if(1&a&&(t.TgZ(0,"nz-card",0),t.YNc(1,ln,4,0,"ng-template",null,1,t.W1O),t.TgZ(3,"div",2)(4,"button",3),t.NdJ("click",function(){return o.showAddModal()}),t._UZ(5,"i",4),t._uU(6," Add Category "),t.qZA()(),t.TgZ(7,"nz-table",5,6)(9,"thead")(10,"tr")(11,"th"),t._uU(12,"Name"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Description"),t.qZA(),t.TgZ(15,"th",7),t._uU(16,"Actions"),t.qZA()()(),t.TgZ(17,"tbody"),t.YNc(18,pn,11,2,"tr",8),t.qZA()()(),t.TgZ(19,"nz-modal",9),t.NdJ("nzVisibleChange",function(l){return o.isModalVisible=l})("nzOnCancel",function(){return o.handleCancel()})("nzOnOk",function(){return o.handleOk()}),t.YNc(20,cn,12,1,"ng-container",10),t.qZA()),2&a){const r=t.MAs(2),l=t.MAs(8);t.Q6J("nzTitle",r),t.xp6(7),t.Q6J("nzData",o.categories)("nzLoading",o.loading)("nzPageSize",10),t.xp6(11),t.Q6J("ngForOf",l.data),t.xp6(1),t.Q6J("nzVisible",o.isModalVisible)("nzTitle",o.isEditing?"Edit Category":"Add Category")("nzOkLoading",o.modalLoading)}},dependencies:[h.sg,_._Y,_.Fj,_.JJ,_.JL,_.sg,_.u,Q.bd,C.N8,C.Uo,C._C,C.Om,C.p0,C.$Z,F.ix,D.w,B.dQ,T.Ls,W.Zp,U.t3,U.SK,y.Lr,y.Nx,y.iK,y.Fd,k.SY,H.du,H.Hf,G.JW]}),n})()},{path:"create",component:lt},{path:"edit/:id",component:lt},{path:"all",component:mt,pathMatch:"full"}];let gn=(()=>{const s=class{};let n=s;return s.\u0275fac=function(a){return new(a||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[L.Bz.forChild(dn),L.Bz]}),n})();var mn=p(2577),_n=p(6903);let hn=(()=>{const s=class{};let n=s;return s.\u0275fac=function(a){return new(a||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[h.ez,_.u5,_.UX,gn,Q.vh,C.HQ,F.sL,T.PV,W.o7,y.U5,I.LV,K.X,U.Jb,mn.S,_n.zf,k.cg,E.Hb,X.Zf,H.Qp,G._p,J.gR,nn]}),n})()}}]);