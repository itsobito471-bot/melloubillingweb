"use strict";(self.webpackChunkmellou_billing=self.webpackChunkmellou_billing||[]).push([[15],{6015:(he,v,o)=>{o.r(v),o.d(v,{UsersModule:()=>ue});var g=o(6895),d=o(433),p=o(8717),_=o(6616),x=o(1971),T=o(6672),u=o(1102),m=o(3910),z=o(6704),h=o(5635),f=o(8231),b=o(9651),C=o(6497),P=o(445),e=o(4650),y=o(6287),M=o(7582),S=o(7579),H=o(2722),F=o(4004),N=o(2536),I=o(8932),L=o(1519);function k(t,a){if(1&t&&(e.ynx(0),e._UZ(1,"span",9),e.BQk()),2&t){const n=a.$implicit,r=e.oxw(2);e.xp6(1),e.Q6J("nzType",n||r.getBackIcon())}}function B(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"div",6),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.onBack())}),e.TgZ(1,"div",7),e.YNc(2,k,2,1,"ng-container",8),e.qZA()()}if(2&t){const n=e.oxw();e.xp6(2),e.Q6J("nzStringTemplateOutlet",n.nzBackIcon)}}function Q(t,a){if(1&t&&(e.ynx(0),e._uU(1),e.BQk()),2&t){const n=e.oxw(2);e.xp6(1),e.Oqu(n.nzTitle)}}function J(t,a){if(1&t&&(e.TgZ(0,"span",10),e.YNc(1,Q,2,1,"ng-container",8),e.qZA()),2&t){const n=e.oxw();e.xp6(1),e.Q6J("nzStringTemplateOutlet",n.nzTitle)}}function V(t,a){1&t&&e.Hsn(0,6,["*ngIf","!nzTitle"])}function Y(t,a){if(1&t&&(e.ynx(0),e._uU(1),e.BQk()),2&t){const n=e.oxw(2);e.xp6(1),e.Oqu(n.nzSubtitle)}}function w(t,a){if(1&t&&(e.TgZ(0,"span",11),e.YNc(1,Y,2,1,"ng-container",8),e.qZA()),2&t){const n=e.oxw();e.xp6(1),e.Q6J("nzStringTemplateOutlet",n.nzSubtitle)}}function E(t,a){1&t&&e.Hsn(0,7,["*ngIf","!nzSubtitle"])}const G=[[["nz-breadcrumb","nz-page-header-breadcrumb",""]],[["nz-avatar","nz-page-header-avatar",""]],[["nz-page-header-tags"],["","nz-page-header-tags",""]],[["nz-page-header-extra"],["","nz-page-header-extra",""]],[["nz-page-header-content"],["","nz-page-header-content",""]],[["nz-page-header-footer"],["","nz-page-header-footer",""]],[["nz-page-header-title"],["","nz-page-header-title",""]],[["nz-page-header-subtitle"],["","nz-page-header-subtitle",""]]],q=["nz-breadcrumb[nz-page-header-breadcrumb]","nz-avatar[nz-page-header-avatar]","nz-page-header-tags, [nz-page-header-tags]","nz-page-header-extra, [nz-page-header-extra]","nz-page-header-content, [nz-page-header-content]","nz-page-header-footer, [nz-page-header-footer]","nz-page-header-title, [nz-page-header-title]","nz-page-header-subtitle, [nz-page-header-subtitle]"];let A=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275dir=e.lG2({type:t,selectors:[["nz-page-header-extra"],["","nz-page-header-extra",""]],hostAttrs:[1,"ant-page-header-heading-extra"],exportAs:["nzPageHeaderExtra"]}),t})(),Z=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275dir=e.lG2({type:t,selectors:[["nz-page-header-footer"],["","nz-page-header-footer",""]],hostAttrs:[1,"ant-page-header-footer"],exportAs:["nzPageHeaderFooter"]}),t})(),U=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275dir=e.lG2({type:t,selectors:[["nz-breadcrumb","nz-page-header-breadcrumb",""]],exportAs:["nzPageHeaderBreadcrumb"]}),t})(),ee=(()=>{class t{constructor(n,r,i,s,l,c){this.location=n,this.nzConfigService=r,this.elementRef=i,this.nzResizeObserver=s,this.cdr=l,this.directionality=c,this._nzModuleName="pageHeader",this.nzBackIcon=null,this.nzGhost=!0,this.nzBack=new e.vpe,this.compact=!1,this.destroy$=new S.x,this.dir="ltr"}ngOnInit(){this.directionality.change?.pipe((0,H.R)(this.destroy$)).subscribe(n=>{this.dir=n,this.cdr.detectChanges()}),this.dir=this.directionality.value}ngAfterViewInit(){this.nzResizeObserver.observe(this.elementRef).pipe((0,F.U)(([n])=>n.contentRect.width),(0,H.R)(this.destroy$)).subscribe(n=>{this.compact=n<768,this.cdr.markForCheck()})}onBack(){if(this.nzBack.observers.length)this.nzBack.emit();else{if(!this.location)throw new Error(`${I.Bq} you should import 'RouterModule' or register 'Location' if you want to use 'nzBack' default event!`);this.location.back()}}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}getBackIcon(){return"rtl"===this.dir?"arrow-right":"arrow-left"}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(g.Ye,8),e.Y36(N.jY),e.Y36(e.SBq),e.Y36(L.D3),e.Y36(e.sBO),e.Y36(P.Is,8))},t.\u0275cmp=e.Xpm({type:t,selectors:[["nz-page-header"]],contentQueries:function(n,r,i){if(1&n&&(e.Suo(i,Z,5),e.Suo(i,U,5)),2&n){let s;e.iGM(s=e.CRH())&&(r.nzPageHeaderFooter=s.first),e.iGM(s=e.CRH())&&(r.nzPageHeaderBreadcrumb=s.first)}},hostAttrs:[1,"ant-page-header"],hostVars:10,hostBindings:function(n,r){2&n&&e.ekj("has-footer",r.nzPageHeaderFooter)("ant-page-header-ghost",r.nzGhost)("has-breadcrumb",r.nzPageHeaderBreadcrumb)("ant-page-header-compact",r.compact)("ant-page-header-rtl","rtl"===r.dir)},inputs:{nzBackIcon:"nzBackIcon",nzTitle:"nzTitle",nzSubtitle:"nzSubtitle",nzGhost:"nzGhost"},outputs:{nzBack:"nzBack"},exportAs:["nzPageHeader"],ngContentSelectors:q,decls:13,vars:5,consts:[[1,"ant-page-header-heading"],[1,"ant-page-header-heading-left"],["class","ant-page-header-back",3,"click",4,"ngIf"],["class","ant-page-header-heading-title",4,"ngIf"],[4,"ngIf"],["class","ant-page-header-heading-sub-title",4,"ngIf"],[1,"ant-page-header-back",3,"click"],["role","button","tabindex","0",1,"ant-page-header-back-button"],[4,"nzStringTemplateOutlet"],["nz-icon","","nzTheme","outline",3,"nzType"],[1,"ant-page-header-heading-title"],[1,"ant-page-header-heading-sub-title"]],template:function(n,r){1&n&&(e.F$t(G),e.Hsn(0),e.TgZ(1,"div",0)(2,"div",1),e.YNc(3,B,3,1,"div",2),e.Hsn(4,1),e.YNc(5,J,2,1,"span",3),e.YNc(6,V,1,0,"ng-content",4),e.YNc(7,w,2,1,"span",5),e.YNc(8,E,1,0,"ng-content",4),e.Hsn(9,2),e.qZA(),e.Hsn(10,3),e.qZA(),e.Hsn(11,4),e.Hsn(12,5)),2&n&&(e.xp6(3),e.Q6J("ngIf",null!==r.nzBackIcon),e.xp6(2),e.Q6J("ngIf",r.nzTitle),e.xp6(1),e.Q6J("ngIf",!r.nzTitle),e.xp6(1),e.Q6J("ngIf",r.nzSubtitle),e.xp6(1),e.Q6J("ngIf",!r.nzSubtitle))},dependencies:[g.O5,y.f,u.Ls],encapsulation:2,changeDetection:0}),(0,M.gn)([(0,N.oS)()],t.prototype,"nzGhost",void 0),t})(),te=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[P.vT,g.ez,y.T,u.PV]}),t})();var ne=o(6903),D=o(4575),ae=o(4239),re=o(7044),oe=o(1811),O=o(3679);function ie(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td")(6,"nz-tag",9),e._uU(7),e.ALo(8,"uppercase"),e.qZA()(),e.TgZ(9,"td")(10,"nz-tag",9),e._uU(11),e.ALo(12,"uppercase"),e.qZA()(),e.TgZ(13,"td"),e._uU(14),e.ALo(15,"date"),e.qZA(),e.TgZ(16,"td")(17,"button",10),e.NdJ("nzOnConfirm",function(){const s=e.CHM(n).$implicit,l=e.oxw();return e.KtG(l.toggleStatus(s))}),e._uU(18),e.qZA()()()}if(2&t){const n=a.$implicit;e.xp6(2),e.Oqu(n.username),e.xp6(2),e.Oqu(n.email),e.xp6(2),e.Q6J("nzColor","admin"===n.role?"volcano":"blue"),e.xp6(1),e.hij(" ",e.lcZ(8,10,n.role)," "),e.xp6(3),e.Q6J("nzColor","active"===n.status?"success":"error"),e.xp6(1),e.hij(" ",e.lcZ(12,12,n.status)," "),e.xp6(3),e.Oqu(e.xi3(15,14,n.createdAt,"medium")),e.xp6(3),e.Q6J("nzDanger","active"===n.status)("nzPopconfirmTitle","active"===n.status?"Are you sure to revoke access?":"Are you sure to restore access?"),e.xp6(1),e.hij(" ","active"===n.status?"Revoke Access":"Restore Access"," ")}}function se(t,a){1&t&&(e.ynx(0),e._uU(1,"The input is not valid E-mail!"),e.BQk())}function de(t,a){1&t&&(e.ynx(0),e._uU(1,"Please input E-mail!"),e.BQk())}function le(t,a){if(1&t&&(e.YNc(0,se,2,0,"ng-container",28),e.YNc(1,de,2,0,"ng-container",28)),2&t){const n=a.$implicit;e.Q6J("ngIf",n.hasError("email")),e.xp6(1),e.Q6J("ngIf",n.hasError("required"))}}function ce(t,a){if(1&t){const n=e.EpF();e.TgZ(0,"i",29),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.passwordVisible=!i.passwordVisible)}),e.qZA()}if(2&t){const n=e.oxw(2);e.Q6J("nzType",n.passwordVisible?"eye-invisible":"eye")}}function ge(t,a){if(1&t&&(e.TgZ(0,"div")(1,"form",11)(2,"nz-form-item")(3,"nz-form-label",12),e._uU(4,"Username"),e.qZA(),e.TgZ(5,"nz-form-control",13),e._UZ(6,"input",14),e.qZA()(),e.TgZ(7,"nz-form-item")(8,"nz-form-label",15),e._uU(9,"Email"),e.qZA(),e.TgZ(10,"nz-form-control",16),e._UZ(11,"input",17),e.YNc(12,le,2,2,"ng-template",null,18,e.W1O),e.qZA()(),e.TgZ(14,"nz-form-item")(15,"nz-form-label",19),e._uU(16,"Password"),e.qZA(),e.TgZ(17,"nz-form-control",20)(18,"nz-input-group",21),e._UZ(19,"input",22),e.qZA(),e.YNc(20,ce,1,1,"ng-template",null,23,e.W1O),e.qZA()(),e.TgZ(22,"nz-form-item")(23,"nz-form-label",24),e._uU(24,"Role"),e.qZA(),e.TgZ(25,"nz-form-control")(26,"nz-select",25),e._UZ(27,"nz-option",26)(28,"nz-option",27),e.qZA()()()()()),2&t){const n=e.MAs(13),r=e.MAs(21),i=e.oxw();e.xp6(1),e.Q6J("formGroup",i.userForm),e.xp6(9),e.Q6J("nzErrorTip",n),e.xp6(8),e.Q6J("nzSuffix",r),e.xp6(1),e.Q6J("type",i.passwordVisible?"text":"password")}}const pe=[{path:"",component:(()=>{const a=class{constructor(r,i,s){this.appService=r,this.message=i,this.fb=s,this.users=[],this.loading=!1,this.total=0,this.pageSize=10,this.pageIndex=1,this.isModalVisible=!1,this.isOkLoading=!1,this.passwordVisible=!1}ngOnInit(){this.loadUsers(),this.initForm()}initForm(){this.userForm=this.fb.group({username:["",[d.kI.required]],email:["",[d.kI.required,d.kI.email]],password:["",[d.kI.required,d.kI.minLength(6)]],role:["user",[d.kI.required]]})}loadUsers(){this.loading=!0,this.appService.getUsers(this.pageIndex,this.pageSize).subscribe({next:r=>{this.users=r.users,this.total=r.total,this.loading=!1},error:r=>{this.message.error(r.message||"Failed to load users"),this.loading=!1}})}onQueryParamsChange(r){const{pageIndex:i,pageSize:s}=r;this.pageIndex=i,this.pageSize=s,this.loadUsers()}showModal(){this.isModalVisible=!0,this.userForm.reset({role:"user"})}handleCancel(){this.isModalVisible=!1}handleOk(){this.userForm.valid?(this.isOkLoading=!0,this.appService.createUser(this.userForm.value).subscribe({next:()=>{this.message.success("User created successfully"),this.isModalVisible=!1,this.isOkLoading=!1,this.loadUsers()},error:r=>{this.message.error(r.message||"Failed to create user"),this.isOkLoading=!1}})):Object.values(this.userForm.controls).forEach(r=>{r.invalid&&(r.markAsDirty(),r.updateValueAndValidity({onlySelf:!0}))})}toggleStatus(r){this.appService.toggleUserStatus(r._id).subscribe({next:i=>{this.message.success(i.message),this.loadUsers()},error:i=>{this.message.error(i.message||"Action failed")}})}};let t=a;return a.\u0275fac=function(i){return new(i||a)(e.Y36(ae.z),e.Y36(b.dD),e.Y36(d.qu))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-user-list"]],decls:27,vars:10,consts:[[1,"page-container"],["nzTitle","User Management","nzSubtitle","Create and manage application users",1,"site-page-header"],["nz-button","","nzType","primary",3,"click"],["nz-icon","","nzType","plus"],[3,"nzData","nzLoading","nzTotal","nzPageIndex","nzPageSize","nzFrontPagination","nzPageIndexChange","nzPageSizeChange","nzQueryParamsChange"],["basicTable",""],[4,"ngFor","ngForOf"],["nzTitle","Create New User",3,"nzVisible","nzOkLoading","nzWidth","nzVisibleChange","nzOnCancel","nzOnOk"],[4,"nzModalContent"],[3,"nzColor"],["nz-button","","nzType","default","nz-popconfirm","",3,"nzDanger","nzPopconfirmTitle","nzOnConfirm"],["nz-form","","nzLayout","vertical",3,"formGroup"],["nzRequired","","nzFor","username"],["nzErrorTip","Please input username!"],["nz-input","","formControlName","username","id","username","placeholder","Enter username"],["nzRequired","","nzFor","email"],[3,"nzErrorTip"],["nz-input","","formControlName","email","id","email","placeholder","Enter email address"],["emailErrorTpl",""],["nzRequired","","nzFor","password"],["nzErrorTip","Password must be at least 6 characters!"],[3,"nzSuffix"],["nz-input","","formControlName","password","id","password","placeholder","Enter password",3,"type"],["suffixTemplate",""],["nzRequired","","nzFor","role"],["formControlName","role","id","role","nzPlaceHolder","Select a role"],["nzValue","user","nzLabel","User"],["nzValue","admin","nzLabel","Admin"],[4,"ngIf"],["nz-icon","",3,"nzType","click"]],template:function(i,s){if(1&i&&(e.TgZ(0,"div",0)(1,"nz-page-header",1)(2,"nz-page-header-extra")(3,"button",2),e.NdJ("click",function(){return s.showModal()}),e._UZ(4,"i",3),e._uU(5," Add User "),e.qZA()()(),e.TgZ(6,"nz-card")(7,"nz-table",4,5),e.NdJ("nzPageIndexChange",function(c){return s.pageIndex=c})("nzPageSizeChange",function(c){return s.pageSize=c})("nzQueryParamsChange",function(c){return s.onQueryParamsChange(c)}),e.TgZ(9,"thead")(10,"tr")(11,"th"),e._uU(12,"Username"),e.qZA(),e.TgZ(13,"th"),e._uU(14,"Email"),e.qZA(),e.TgZ(15,"th"),e._uU(16,"Role"),e.qZA(),e.TgZ(17,"th"),e._uU(18,"Status"),e.qZA(),e.TgZ(19,"th"),e._uU(20,"Created At"),e.qZA(),e.TgZ(21,"th"),e._uU(22,"Action"),e.qZA()()(),e.TgZ(23,"tbody"),e.YNc(24,ie,19,17,"tr",6),e.qZA()()(),e.TgZ(25,"nz-modal",7),e.NdJ("nzVisibleChange",function(c){return s.isModalVisible=c})("nzOnCancel",function(){return s.handleCancel()})("nzOnOk",function(){return s.handleOk()}),e.YNc(26,ge,29,4,"div",8),e.qZA()()),2&i){const l=e.MAs(8);e.xp6(7),e.Q6J("nzData",s.users)("nzLoading",s.loading)("nzTotal",s.total)("nzPageIndex",s.pageIndex)("nzPageSize",s.pageSize)("nzFrontPagination",!1),e.xp6(17),e.Q6J("ngForOf",l.data),e.xp6(1),e.Q6J("nzVisible",s.isModalVisible)("nzOkLoading",s.isOkLoading)("nzWidth",480)}},dependencies:[g.sg,g.O5,d._Y,d.Fj,d.JJ,d.JL,d.sg,d.u,p.N8,p.Uo,p._C,p.Om,p.p0,p.$Z,_.ix,re.w,oe.dQ,x.bd,T.j,u.Ls,m.du,m.Hf,O.t3,O.SK,z.Lr,z.Nx,z.iK,z.Fd,h.Zp,h.gB,h.ke,f.Ip,f.Vq,C.JW,ee,A,g.gd,g.uU],styles:[".page-container[_ngcontent-%COMP%]{padding:24px}.site-page-header[_ngcontent-%COMP%]{background:#fff;margin-bottom:24px;border:1px solid rgb(235,237,240);border-radius:8px}nz-card[_ngcontent-%COMP%]{border-radius:8px;box-shadow:0 4px 12px #0000000d}.ant-tag[_ngcontent-%COMP%]{min-width:60px;text-align:center}nz-form-item[_ngcontent-%COMP%]{margin-bottom:16px}nz-form-label[_ngcontent-%COMP%]{padding-bottom:4px!important}nz-modal[_ngcontent-%COMP%]     .ant-modal-footer{border-top:none;padding:16px 24px}nz-modal[_ngcontent-%COMP%]     .ant-modal-header{border-bottom:1px solid #f0f0f0}"]}),t})()}];let ze=(()=>{const a=class{};let t=a;return a.\u0275fac=function(i){return new(i||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[D.Bz.forChild(pe),D.Bz]}),t})(),ue=(()=>{const a=class{};let t=a;return a.\u0275fac=function(i){return new(i||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[g.ez,ze,d.UX,d.u5,p.HQ,_.sL,x.vh,T.X,u.PV,m.Qp,z.U5,h.o7,f.LV,b.gR,C._p,te,ne.zf]}),t})()}}]);