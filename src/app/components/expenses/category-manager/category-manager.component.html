<nz-card [nzTitle]="titleTemplate">
    <ng-template #titleTemplate>
        <div style="display: flex; align-items: center;">
            <i nz-icon nzType="arrow-left" nzTheme="outline"
                style="cursor: pointer; margin-right: 16px; font-size: 18px;" (click)="goBack()"
                nz-tooltip="Back to Expenses"></i>
            <span style="font-size: 18px; font-weight: bold;">Expense Categories</span>
        </div>
    </ng-template>

    <div style="margin-bottom: 16px; text-align: right;">
        <button nz-button nzType="primary" (click)="showAddModal()">
            <i nz-icon nzType="plus"></i> Add Category
        </button>
    </div>

    <nz-table #categoryTable [nzData]="categories" [nzLoading]="loading" [nzPageSize]="10">
        <thead>
            <tr>
                <th>Name</th>
                <th>Description</th>
                <th nzWidth="120px">Actions</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let data of categoryTable.data">
                <td><strong>{{ data.name }}</strong></td>
                <td>{{ data.description || '-' }}</td>
                <td>
                    <button nz-button nzType="text" (click)="showEditModal(data)">
                        <i nz-icon nzType="edit" nzTheme="outline" style="color: #1890ff;"></i>
                    </button>
                    <button nz-button nzType="text" nz-popconfirm nzPopconfirmTitle="Sure to delete?"
                        (nzOnConfirm)="deleteCategory(data._id)">
                        <i nz-icon nzType="delete" nzTheme="outline" style="color: #ff4d4f;"></i>
                    </button>
                </td>
            </tr>
        </tbody>
    </nz-table>
</nz-card>

<nz-modal [(nzVisible)]="isModalVisible" [nzTitle]="isEditing ? 'Edit Category' : 'Add Category'"
    (nzOnCancel)="handleCancel()" (nzOnOk)="handleOk()" [nzOkLoading]="modalLoading">
    <ng-container *nzModalContent>
        <form nz-form [formGroup]="categoryForm" nzLayout="vertical">
            <nz-form-item>
                <nz-form-label nzRequired>Category Name</nz-form-label>
                <nz-form-control nzErrorTip="Please enter name">
                    <input nz-input formControlName="name" placeholder="E.g. Rent, Utilities" />
                </nz-form-control>
            </nz-form-item>
            <nz-form-item>
                <nz-form-label>Description</nz-form-label>
                <nz-form-control>
                    <textarea nz-input formControlName="description" placeholder="Description (Optional)"
                        rows="3"></textarea>
                </nz-form-control>
            </nz-form-item>
        </form>
    </ng-container>
</nz-modal>